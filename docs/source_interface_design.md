# Source Interface Selection Design

## Contents
   - [High level design of source interface selection](#high-level-design-of-source-interface-selection)
   - [Internal structure](#internal-structure)
   - [OVSDB schema](#ovsdb-schema)
       - [VRF table](#vrf-table)
   - [References](#references)

## High level design of source interface selection

The source IP address is determined by the system and is usually the
IP address of the outgoing interface in the routing table. However, routing
switches may have multiple routing interfaces due to load balancing or routing
redundancy, and outgoing packets can potentially be sent by different paths at
different times. This results in different source IP addresses, which creates
a client identification problem on the server site. To decrease the amount of
administrative work involved, a configuration model is provided that allows
the selection of an IP address to use as the source address for all outgoing
traffic generated by a specified software application on the switch. This
allows unique identification of the software application on the server site
regardless of which local interface has been used to reach the destination
server. The source interface selection supports selecting an IP address
or interface name.

The source interface selection configuration can be done by the user
through CLI. The CLI daemon updates the source interface selection configuration
into the OVSDB. The protocol daemon gets the configuration update from the OVSDB
and sets the source IP for all outgoing packets.

The source interface selection is supported only for IPv4.

## Internal structure

```ditaa
Source Interface Selection

+----------------+           +----------------------+             +-----------------+
|   CLI          +----------->                      |             |                 |
|  daemon        |           |       OVSDB          +------------->   Protocol      |
|                <-----------+                      |             |   daemon        |
+----------------+           +----------------------+             +-----------------+
```

## OVSDB schema
### VRF table
```
VRF:source_ip
Keys:
tftp
Value: source IP address for TFTP protocol.
tacacs
Value: source IP address for TACACS protocol.
radius
Value: source IP address for RADIUS protocol.
all
Value: source IP address for all the suported protocols.

VRF:source_interface
Keys:
tftp
Value: source interface for TFTP protocol.
tacacs
Value: source interface for TACACS protocol.
radius
Value: source interface for RADIUS protocol.
all
Value: source interface for all the suported protocols.
```

## References
* Click [here](documents/user/source_interface_user_guide) for source interface
selection user guide.
* Click [here](documents/user/source_interface_cli) for source interface
selection CLI guide.
